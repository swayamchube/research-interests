\section{General Valuations and Valuation Rings}

\begin{definition}[Valuation]
    A \emph{valuation} on a field $K$ is a map $v: K\to\Gamma\cup\{\infty\}$ where $\Gamma$ is an ordered abelian group such that for all $x,y\in K$,
    \begin{enumerate}
        \item $v(xy) = v(x) + v(y)$, that is, the restriction $v: K^\times\to\Gamma$ is a group homomorphism,
        \item $v(x + y)\ge\min\{v(x), v(y)\}$.
    \end{enumerate}
    The set 
    \begin{equation*}
        A = \{x\in K^\times\mid v(x)\ge 0\}
    \end{equation*}
    is called the \emph{valuation ring} of $K$ with respect to the valuation $v$. Simply stating ``$A$ is a valuation ring'' means $A$ is a valuation ring of $K = Q(A)$.
\end{definition}

That the set $A$ forms a ring follows from the fact that it is closed under addition, multiplication and subtraction.

\begin{proposition}
    Let $A$ be an integral domain and $K = Q(A)$, its field of fractions. Then, $A$ is a \emph{valuation ring} of $K$ iff for every $x\in K\backslash\{0\}$, we have $x\in A$ or $x^{-1}\in A$.
\end{proposition}
\begin{proof}
    The forward direction from the fact that $0 = v(1) = v(xx^{-1}) = v(x) + v(x^{-1})$. Conversely, let $\Gamma = K^\times/A^\times$ and $\pi: K^\times\onto\Gamma$ the natural projection. Define an order on $\Gamma$ as follows 
    \begin{itemize}
        \item Every element in $G$ is of the form $\pi(x)$ for $x\in K^\times$. According to the given hypothesis, $x\in A$ or $x^{-1}\in A$. In the former case, let $\pi(x)\ge 1_\Gamma$ and in the latter, $\pi(x) < 1_\Gamma$.
        \item To see that this is well defined, suppose $x,y\in K$ with $x/y\in A^\times$, then if $x\in A$ then $y = xu\in A$ where $u\in A^\times$, on the other hand, if $x^{-1}\in A$, then $y^{-1} = ux^{-1}\in A$ where $u\in A^\times$.
        \item This extends to a total order on $\Gamma$ by $\pi(x)\ge\pi(y)$ if and only if $\pi(xy^{-1})\ge 1_\Gamma$, that is, $xy^{-1}\in A$.
    \end{itemize}

    We now contend that $\pi$ is a valuation with valuation ring $A$. Since $\pi$ is a homomorphism, it suffices to check $\pi(x + y)\ge\min\{\pi(x),\pi(y)\}$. Indeed, suppose $\pi(x)\ge\pi(y)$, which is equivalent to stating $x/y\in A$. Then, $1 + x/y\in A$, consequently 
    \begin{equation*}
        \pi(x + y) = \pi(y(1 + x/y)) = \pi(y)\pi(1 + x/y)\ge\pi(y).
    \end{equation*}
    This completes the proof.
\end{proof}

\begin{proposition}
    Let $A$ be a valuation ring. Then 
    \begin{enumerate}[label=(\alph*)]
        \item $A$ is a local ring. 
        \item $A$ is normal.
    \end{enumerate}
\end{proposition}
\begin{proof}
\begin{enumerate}[label=(\alph*)]
    \item We shall show that the nonunits in $A$ form an ideal. Let $\frakm$ be the set of nonunits in $A$ and choose $x\in\frakm\backslash\{0\}$, $b\in A$. Then, $bx\ne 0$ since $x$ is not a zero divisor. We contend that $bx$ is a nonunit. For if not, then $b(bx)^{-1}$ would be an inverse of $x$.

    Next, let $x,y\in\frakm\backslash\{0\}$. According to the given condition, either $x/y$ or $y/x$ are in $A$. Without loss of generality, suppose $x/y\in A$. Then $x + y = y(1 + x/y)\in\frakm$ from the conclusion of the previous paragraph. Thus $\frakm$ is an ideal and $A$ is local.

    \item Indeed, let $\alpha\in K$ be integral over $A$. If $\alpha\in A$, there is nothing to prove. If not, then it satisifes an equation of the form 
    \begin{equation*}
        \alpha^n + b_{n - 1}\alpha^{n - 1} + \cdots + b_1\alpha + b_0
    \end{equation*}
    Upon multiplying by $\alpha^{-(n - 1)}$, we can represent $\alpha$ as a sum of elements in $A$, consequently, is an element of $A$, a contradiction.
\end{enumerate}
\end{proof}

\begin{proposition}
    Let $A$ be a domain. Then $A$ is a valuation ring if and only if the ideals in $A$ are totally ordered.
\end{proposition}
\begin{proof}
    $(\implies)$ Suppose not. Then, there are two distinct ideals $\fraka,\frakb$ with $\fraka\not\subseteq\frakb$ and $\frakb\not\subseteq\fraka$ whence we can pick $a\in\fraka\backslash\frakb$ and $b\in\frakb\backslash\fraka$. Since either $a/b\in A$ or $b/a\in A$, we must have $a|b$ or $b|a$. Without loss of generality, suppose $b|a$. Then, $a\in(b)\subseteq\frakb$, a contradiction. 

    $(\impliedby)$ Let $x = a/b\in K$. Consider the ideals $(a)$ and $(b)$ in $A$. Since the ideals of $A$ are totally ordered, either $(a)\subseteq (b)$ or $(b)\subseteq (a)$, and thus, either $x\in A$ or $x^{-1}\in A$. This completes the proof.
\end{proof}

\begin{definition}[B\'ezout Ring]
    A ring is said to be a \emph{B\'ezout ring} if every finitely generated ideal is principal.
\end{definition}

\begin{proposition}
    A ring is a valuation ring if and only if it is a local B\'ezout domain.
\end{proposition}
\begin{proof}
    Let $A$ be a valuation ring and $\fraka = (a_1,\ldots,a_n) = (a_1) + \cdots + (a_n)$. Since ideals in a valuation ring are totally ordered, there is an index $i$ such that $(a_j)\subseteq(a_i)$ for $1\le j\le n$, consequently, $\fraka = (a_i)$.

    Conversely, let $A$ be a local B\'ezout Domain and $x = a/b\in K = Q(A)$. If either $a$ or $b$ is a unit, then either $x$ or $x^{-1}\in A$. Then, there is $c\in A$ such that $(c) = (a,b)$ whence there are $a',b'\in A$ such that $a = ca'$ and $b = cb'$. Let $u\in A$ be such that $(u) = (a',b')$. Then, $(cu') = (c)$ whence $u$ is a unit. If neither $a'$ or $b'$ is a unit, then $(1) = (a',b') = (a') + (b')\subseteq\frakm$, a contradiction. Thus, either $a|b$ or $b|a$ which completes the proof.
\end{proof}

\section{Discrete Valuation Rings}

\begin{definition}[Discrete Valuation Ring]
    A valuation $v: K\to\Gamma\cup\{\infty\}$ is said to be a \emph{discrete valuation} when $\Gamma = \Z$ and $v$ is surjective. An integral domain $A$ is said to be a \emph{discrete valuation ring} if there is a discrete valuation $v$ on the field of fractions of $A$ such that $A$ is the corresponding valuation ring.
\end{definition}

First, since $A$ is a valuation ring of its field of fractions, say $K$, it is local and normal, i.e. integrally closed in $K$. Further, the maximal ideal $\frakm$ in $A$ is the set of all $x\in A$ with \underline{positive} valuations.

\begin{proposition}\thlabel{prop:dvr-is-local-pid}
    Let $A$ be a DVR. Then, $A$ is a local PID.
\end{proposition}
\begin{proof}
    Let $\frakm_k = \{x\in A\mid v(x)\ge k\}$. We first show that $\frakm_k$ is an ideal. Indeed, for all $x,y\in\frakm_k$, 
    \begin{equation*}
        v(x - y)\ge\min\{v(x), v(-y)\} = \min\{v(x),v(y)\}\ge k
    \end{equation*}
    and $v(xy) = v(x) + v(y)\ge k$.

    Next, we show that every non-zero ideal $\fraka$ in $A$ is one of the $\frakm_i$'s. Due to the well ordering of the naturals, there is an $x\in\fraka$ with $\displaystyle k = v(x) = \min_{a\in\fraka}v(a)$. Then, by the choice of $k$, $\fraka\subseteq\frakm_k$. Now, let $y\in\frakm_k$. Since $v$ is surjective, there is an element $z\in A$ with $v(z) = v(y) - v(x)$. Whence $xz\in\fraka$ and $v(xz) = v(y)$. Since $(xz) = (y)$, we must have $y\in\fraka$.

    Notice that these ideals form a descending chain 
    \begin{equation*}
        \frakm = \frakm_1\supseteq\frakm_2\supseteq\cdots.
    \end{equation*}

    Choose some $a\in A$ with $v(a) = 1$, which exists due to the surjectivity of $v$. Then, $\frakm = (a)$ and consequently, $\frakm_k = (a^k) = \frakm^k$. From this, we may conclude that $\frakm$ is the unique non-zero prime ideal in $A$ and every other ideal is a power of $\frakm$ and also principal. Thus $A$ is a local PID.
\end{proof}

\begin{theorem}\thlabel{thm:dvr-equivalence}
    Let $A$ be a noetherian local domain of Krull dimension $1$, $\frakm$ its maximal ideal and $k = A/\frakm$ its residue field. Then the following are equivalent: 
    \begin{enumerate}[label=(\alph*)]
        \item $A$ is a discrete valuation ring.
        \item $A$ is normal.
        \item $\frakm$ is principal. 
        \item $\dim_k(\frakm/\frakm^2) = 1$.
        \item Every non-zero ideal is a power of $\frakm$. 
        \item There is $x\in A$ such that every nonzero ideal is of the form $(x^k)$ for $k\ge 0$. 
    \end{enumerate}
\end{theorem}
\begin{proof}
    $(a)\implies(b)$ is obvious. 

    $(b)\implies(c)$. Let $a\in\frakm$. Since the ring is noetherian, $(a)$ has a primary decomposition, but since the Krull dimension is $1$, the only non-zero prime ideal is $\frakm$, we see that $\sqrt{(a)} = \frakm$. Since we are in a noethering, there is a positive integer $n$ such that $\frakm^n\subseteq (a)$ but $\frakm^{n - 1}\subsetneq(a)$. Let $b\in\frakm^{n - 1}\backslash(a)$ and $x = a/b$, $y = x^{-1} = b/a$ in $K = Q(A)$, the field of fractions. 

    First, since $b\notin(a)$, $y\notin A$ and therefore, is not integral over $A$. Since $\frakm$ is a finitely generated $A$-module, it cannot be an $A[y]$-module lest $y$ be integral over $A$ due to \thref{thm:equivalence-integral-extension}. Hence, $y\frakm\subsetneq\frakm$.

    Now consider $y\frakm$. For any $z\in\frakm$, $yz = bz/a\in A$ since $bz\in\frakm^n\subseteq(a)$. Thus, $y\frakm\subseteq A$. Since this is an ideal and is not contained in $\frakm$, we must have $y\frakm = A$, whence $\frakm = Ax = (x)$ and is principal. 

    $(c)\implies(d)$. Let $\frakm = (a)$ for some $a\in A$. Then, $\frakm/\frakm^2 = (\overline a)$ where $\overline a$ is the image of $a$. Thus, $\dim_k(\frakm/\frakm^2)\le 1$. Now, note that $\frakm\ne\frakm^2$, lest due to \thref{lem:nakayama}, we have $\frakm = 0$. Thus, $\dim_k(\frakm/\frakm^2)\ge 1$ and the conclusion follows.

    $(d)\implies(e)$. Let $\fraka$ be a proper non-zero ideal in $A$. Then, $\sqrt{\fraka} = \frakm$ as we have argued earlier and thus, there is a least positive integer $n$ such that $\frakm^n\subseteq\fraka$. Now, $A/\frakm^n$ is an artinian local ring with maximal ideal $\overline\frakm = \frakm/\frakm^2$. Consequently, 
    \begin{equation*}
        \dim_k(\overline\frakm/\overline\frakm^2) = \dim_k(\frakm/\frakm^2) = 1
    \end{equation*}
    whence, due to \texttt{<insert reference>}, every ideal in $A/\frakm^n$ is principal, in particular, $\overline\fraka$ is principal. \todo{Complete This Argument}

    $(e)\implies(f)$. Due to \thref{lem:nakayama}, $\frakm\supsetneq\frakm^2$, hence there is $x\in\frakm\backslash\frakm^2$. According to our hypothesis, $(x) = \frakm^n$ for some positive integer $n$. Due to our choice of $x$, we must have $n = 1$, whence $\frakm = (x)$. The conclusion now follows. 

    $(f)\implies(a)$. We shall explicitly create a valuation. First, note that we have $\frakm = (x)$ due to maximality and due to Nakayama's Lemma, $\frakm^k\ne\frakm^{k + 1}$ for if not, then $\frakm^k = 0$ whereby, $\frakm = 0$, upon taking radicals, a contradiction. 

    For each $a\in A$, $(a) = (x^k)$ for a unique $k$, since $(x^n)\supsetneq(x^{n + 1})$. Define $v(a) = k$ and extend it to $K = Q(A)$ by defining $v(a/b) = v(a) - v(b)$. This is obviously a well defined valuation and $v(a/b)\ge 0$ if and only if $(a) = (x^n)$ and $(b) = (x^m)$ for $n\ge m$, whence $a\in (b)$ and $a/b\in A$. Thus $A$ is the valuation ring of $K$ with respect to $v$. This completes the proof.
\end{proof}

\begin{proposition}
    $A$ is a DVR if and only if $A$ is a local PID which is not a field.
\end{proposition}
\begin{proof}
    If $A$ is a local PID which is not a field, then it is a noetherian local domain of Krull dimension $1$ with a principal maximal ideal. From \thref{thm:dvr-equivalence}, we have that $A$ is a DVR. Putting this together with \thref{prop:dvr-is-local-pid}, we have the desired conclusion.
\end{proof}

\begin{proposition}
    Let $A$ be a valuation ring that is not a field. Then $A$ is a DVR if and only if $A$ is noetherian.
\end{proposition}
\begin{proof}
    It suffices to show the converse. Since $A$ is noetherian, every ideal is finitely generated and thus principal. Hence, $A$ is a DVR.
\end{proof}

\section{Dedekind Domains}

\begin{theorem}\thlabel{thm:dedekind-domain-equivalence}
    Let $A$ be a noetherian domain of Krull dimension $1$. Then, the following are equivalent 
    \begin{enumerate}[label=(\alph*)]
        \item $A$ is integrally closed.
        \item Every primary ideal in $A$ is a prime power.
        \item Every local ring $A_\frakp$ is a discrete valuation ring.
    \end{enumerate}
\end{theorem}
\begin{proof}

\end{proof}

\begin{definition}
    A ring satisfying the equivalent conditions of \thref{thm:dedekind-domain-equivalence}, is said to be a \emph{Dedekind domain}.
\end{definition}

\begin{theorem}
    In a Dedekind domain, every non-zero ideal has a unique factorization as a product of prime\footnote{Which in this case, are maximal.} ideals.
\end{theorem}
\begin{proof}
    From \thref{lem:noether-dim1-ideal-pp}, every ideal in a noetherian domain of Krull dimension $1$ has a unique factorization as a product of prime ideals. Then, from \thref{thm:dedekind-domain-equivalence} and \thref{thm:chinese-remainder}, the conclusion follows.
\end{proof}

\begin{proposition}
    Let $A$ be a Dedekind domain and $\fraka\subseteq A$ a nonzero ideal. Then, $A/\fraka$ is a principal ring.
\end{proposition}
\begin{proof}
    The ideal $\fraka$ has a prime factorization $\fraka = \frakp_1^{n_1}\cdots\frakp_s^{n_s}$ with $A/\fraka\cong\bigoplus_{i = 1}^s A/\frakp_i^{n_i}$. We shall show that each factor $A/\frakp_i^{n_i}$ is a principal ring, by showing that for every prime ideal $\frakp$, the ring $\overline A = A/\frakp^n$ is principal for every positive integer $n$.

    First, note that $\overline A$ must be artinian and local as we have argued in the previous chapters. Hence, due to \thref{lem:artin-local-pir}, it suffices to show that the maximal ideal in $\overline A$ is principal. Note that the maximal ideal in $\overline A$ is given by $p/\frakp^n$. If $n = 1$, then $A/\frakp^n$ is a field and there is nothing to prove. Now, suppose $n\ge 2$. Let $\overline p$ denote the maximal ideal $\frakp/\frakp^n$ in $A$. Then, $\overline\frakp^2 = \frakp^2/\frakp^n$, which may not be equal to $\overline{\frakp}$ due to \thref{lem:nakayama}.

    Choose some $\overline a\in\overline\frakp\backslash\overline\frakp^2$. We contend that $\overline\frakp = (\overline a)$. Let $a\in A$ be an element mapping to $\overline a$ under the projectio $A\twoheadrightarrow A/\frakp^n$. Then, $(a)\supseteq\frakp^n$, consequently, $\sqrt{(a)} = \frakp$ is maximal and thus $(a)$ is $\frakp$-primary, whence a power of $\frakp$. Since we chose $\overline{a}$ in $\overline\frakp\backslash\overline{\frakp}^2$, we must have $(a) = \frakp$ which completes the proof.
\end{proof}

\begin{corollary}
    Every ideal in a Dedekind domain is generated by at most two elements.
\end{corollary}
\begin{proof}
    Let $\fraka\unlhd A$ be an ideal and $a\in\fraka\backslash\{0\}$. Then, $\fraka/(a)$ is a principal ideal. Let $b\in\fraka$ map to a generator of $\fraka/(a)$. Then, $(a,b) = \fraka$.
\end{proof}

\begin{proposition}
    Let $A$ be a Dedekind domain and $\fraka,\frakb,\frakc\subseteq A$ be ideals. Then, 
    \begin{enumerate}[label=(\alph*)]
        \item $\fraka\cap(\frakb + \frakc) = \fraka\cap\frakb + \fraka\cap\frakc$ and
        \item $\fraka + \frakb\cap\frakc = (\fraka + \frakb)\cap(\fraka + \frakc)$.
    \end{enumerate}
\end{proposition}
\begin{proof}
\end{proof}

\begin{proposition}
    A Dedekind domain is a UFD if and only if it is a PID.
\end{proposition}
\begin{proof}
    We shall show only the forward direction since the converse is trivial. Let $\frakp$ be a prime ideal in $A$ and $0\ne a\in\frakp$. Then, $a$ has a factorization, $a = up_1^{e_1}\cdots p_r^{e_r}$ where the $p_i$'s are irreducibles and $e_i > 0$. Since $\frakp$ is a prime ideal, there is some $p_i\in\frakp$, consequently, $(p_i)\subseteq\frakp$. But since $(p_i)$ is a nonzero prime ideal, it must be equal to $\frakp$. Thus, every prime ideal in $A$ is principal and thus $A$ is a PID.
\end{proof}

\begin{proposition}
    A Dedekind domain with finitely many prime ideals is a PID.
\end{proposition}

\section{Fractional Ideals}

\begin{definition}
    Let $A$ be an integral domain. A \emph{fractional ideal} of $A$ is a nonzero $A$-submodule $M$ of $K = Q(A)$, the field of fractions such that there is $d\in A$ with $dM\subseteq A$.
\end{definition}

\begin{remark}
    If $M$ is an $A$-fractional ideal, then for any multiplicatively closed subset $S\subseteq A$ not containing $0$, we have that $S^{-1}M$ is an $S^{-1}A$ fractional ideal. This observation will be quite useful in the future.
\end{remark}

The ideals contained in $A$ are now called ``integral ideals''. Obviously, every integral ideal is fractions. Let $M$ and $N$ be $A$-submodules of $K$. Define the modified colon operator as 
\begin{equation*}
    \langle M: N\rangle = \{x\in K\mid xN\subseteq M\}.
\end{equation*}

Similarly, one defines the sum and product of $A$-submodles of $K$ as 
\begin{align*}
    \sum_{i\in I}M_i &= \left\{\sum_{\text{finite}}m_i\mid m_i\in M_i\right\}\\
    MN &= \left\{\sum_{\text{finite}}x_iy_i\mid x_i\in M,~y_i\in N\right\}
\end{align*}

\begin{proposition}
    Let $M, N, P$ be $A$-submodule of $K = Q(A)$. Then, 
    \begin{equation*}
        M(N + P) = MN + MP
    \end{equation*}
\end{proposition}

\begin{proposition}
    Let $M$ and $N$ be $A$-submodules of $K$ and $S\subseteq A$ a multiplicative subset. Then 
    \begin{enumerate}[label=(\alph*)]
        \item $S^{-1}(MN) = (S^{-1}M)(S^{-1}N)$
        \item $S^{-1}\langle M:N\rangle\subseteq\langle S^{-1}M : S^{-1}N\rangle$. Equality holds when $N$ is finitely generated as an $A$-module.
    \end{enumerate}
\end{proposition}
\begin{proof}
    $(a)$. Let $x = (\sum_i m_in_i)/s\in S^{-1}(MN)$. Then, 
    \begin{equation*}
        x = \sum_{i}(m_i/s)(n_i/1)\in (S^{-1}M)(S^{-1}N).
    \end{equation*}
    On the other hand, if $x\in (S^{-1}M)(S^{-1}N)$, then $x = \sum_i(m_i/s_i)(n_i/t_i) = \sum_i (m_in_i/s_it_i)$. Let $s = \prod s_i$ and $t = \prod t_i$. Then, it is not hard to see that $x = m'n'/st\in S^{-1}(MN)$ and the conclusion follows. 

    $(b)$. The inclusion is obvious. To see the inclusion in the other direction, suppose $N$ were generated by $\{n_1,\dots,n_r\}\subseteq N$. Let $z\in\langle S^{-1}M : S^{-1}N\rangle$ and let $zn_i/1 = m_i/s_i$ with $m_i\in M$ and $s_i\in S$. Set $s = \prod_{i} s_i$. Then, it is clear that $szn_i\in M$ for each $i$ and thus $sz\in\langle M: N\rangle$ whence $z\in S^{-1}\langle M: N\rangle$. This completes the proof.
\end{proof}

\begin{proposition}
    Let $A$ be a noetherian domain. Then an $A$-submodule $M$ of $K = Q(A)$ is a fractional ideal if and only if $M$ is a finitely generated $A$-module.
\end{proposition}
\begin{proof}
    It is not hard to see that every finitely generated $A$-submodule $M$ of $K$ is fractional, for if it is generated by $x_1/y_1,\ldots,x_n/y_n$, then choosing $y = \prod_{i = 1}^n y_i$, we have $yM\subseteq A$.

    On the other hand, if $A$ is noetherian and $M$ a fractional ideal, then there is some $d\in A$ such that $dM\subseteq A$ and is an ideal, say $\fraka\subseteq A$. Thus $M = d^{-1}\fraka$ and is a finitely generated $A$-module.
\end{proof}

\begin{definition}
    Let $A$ be an integral domain. An $A$-submodule $M$ of $K = Q(A)$ is said to be \emph{invertible} if there is an $A$-submodule $N$ of $K$ with $MN = A$. 
\end{definition}

\begin{remark}\thlabel{rem:fractional-inv-iff-integral}
    Each fractional ideal of $A$ is invertible if and only if each integral ideal of $A$ is invertible. Indeed, suppose each integral ideal of $A$ is invertible and $M$ be a fractional ideal of $A$. Then, there is some $d\in A$ such that $dM$ is an integral ideal whence admits an inverse $N$. Then, note that $dN$ is an inverse of $M$.
\end{remark}

For an $A$-submodule $M$ of $K$, define
\begin{equation*}
    \langle A:M\rangle = \{x\in K\mid xM\subseteq A\}.
\end{equation*}
It is not hard to see that $\langle A:M\rangle$ is an $A$-submodule of $K$.

\begin{proposition}
    Let $A$ be an integral domain and $M$ an invertible ideal of $A$. Then, $M^{-1} = \langle A:M\rangle$ and $M$ is finitely generated.
\end{proposition}
\begin{proof}
    Let $N$ denote the inverse of $M$. Then 
    \begin{equation*}
        N\subseteq\langle A:M\rangle = \langle A:M\rangle MN\subseteq AN = N.
    \end{equation*}
    Since $M\langle A:M\rangle = A$, there exist, for $1\le i\le n$, $x_i\in M$ and $y_i\in\langle A:M\rangle$ such that $\sum_{i}x_iy_i = 1$. Hence, for any $x\in M$, we have 
    \begin{equation*}
        x = \sum_{i = 1}^n xx_iy_i = \sum_{i = 1}^n(y_ix)x_i.
    \end{equation*}
    Since each $y_i\in\langle A:M\rangle$, we have $y_ix\in A$ for $1\le i\le n$, thus $M$ is generated by $x_1,\ldots,x_n$, whence finitely generated.
\end{proof}

\begin{proposition}\thlabel{prop:inv-fractional-local}
    Let $M$ be a fractional ideal of an integral domain $A$. Then, the following are equivalent: 
    \begin{enumerate}[label=(\alph*)]
        \item $M$ is invertible. 
        \item $M$ is finitely generated and for each $\frakp\in\spec A$, $M_\frakp$ is invertible. 
        \item $M$ is finitely generated and for each $\frakm\in\mspec A$, $M_\frakm$ is invertible. 
    \end{enumerate}
\end{proposition}
\begin{proof}
    $(a)\implies(b)$ First, since $M$ is invertible, it is finitely generated as an $A$-module. We have 
    \begin{equation*}
        A_\frakp = (M\langle A:M\rangle)_\frakp = M_\frakp\langle A_\frakp:M_\frakp\rangle
    \end{equation*}
    whence $M_\frakp$ is invertible.

    $(b)\implies(c)$ Obvious. 

    $(c)\implies(a)$. Let $\fraka = M\langle A:M\rangle$. This is an integral ideal in $A$. Let $\iota:\fraka\into A$ denote the inclusion and let $\frakm\subseteq A$ be a maximal ideal. Then, 
    \begin{equation*}
        \fraka_\frakm = M_\frakm\langle A_\frakm:M_\frakm\rangle = A_\frakm.
    \end{equation*}
    Thus $\iota_\frakm$ is surjective for all maximal ideals $\frakm$ and due to \thref{prop:inj-surj-local}, $\fraka = A$.
\end{proof}

\begin{proposition}\thlabel{prop:dvr-fractional-ideal}
    Let $A$ be a local domain. Then $A$ is a DVR iff every non-zero fractional ideal of $A$ is invertible.
\end{proposition}
\begin{proof}
    $(\implies)$ Let $M$ be a fractional ideal of $A$ and $\frakm = (x)$. Then, there is $y\in A$ such that $yM\subseteq A$. Let $s > 0$ be chosen such that $(y) = (x^s)$. Then, $x^sM = yM\subseteq A$ is an ordinary ideal and is therefore equal to $(x^r)$ for some non-negative integer $r$. Then, $M = (x^{r - s})$ is principal and thus invertible. 

    $(\impliedby)$ First, every integral ideal is fractional and according to the hypothesis, finitely generated. Thus $A$ is noetherian. We shall now show that every nonzero proper integral ideal is a power of $\frakm$. Suppose not. Let $\Sigma$ be the set of all nonzero proper integral ideals in $A$ which are not powers of $\frakm$. Let $\fraka\in\Sigma$ be a maximal element\footnote{We do not need to invoke Zorn for this since the ring is Noetherian.}. Then, $\fraka\subsetneq\frakm$. But since $\frakm$ is invertible, we have 
    \begin{equation*}
        \frakm^{-1}\fraka\subseteq\frakm^{-1}\frakm = A
    \end{equation*}
    and thus $\frakm^{-1}\fraka$ is a proper integral ideal which contains $\fraka$, since $1\in\frakm^{-1}$. We contend that this containment is proper. For if not, then 
    \begin{equation*}
        \frakm^{-1}\fraka = \fraka\implies\fraka = \frakm\fraka
    \end{equation*}
    and due to \thref{lem:nakayama}, $\fraka = 0$. Thus, $\fraka\subsetneq\frakm^{-1}\fraka$ and due to the maximality of $\fraka$, there is a positive integer $k$ such that $\frakm^{-1}\fraka = \frakm^k$ whence $\fraka = \frakm^{k + 1}$, a contradiction. This completes the proof.
\end{proof}

\begin{proposition}
    Let $A$ be an integral domain. Then $A$ is a Dedekind domain iff every non-zero fractional ideal of $A$ is invertible.
\end{proposition}
\begin{proof}
    $(\implies)$ Let $M$ be a fractional ideal in $A$. Since $A$ is also noetherian, $M$ is finitely generated. Let $\frakp\in\spec A$. Then $M_\frakp$ is a fractional ideal in the DVR $A_\frakp$ whence invertible. We are done due to \thref{prop:inv-fractional-local}.

    $(\impliedby)$ We shall show that $A_\frakp$ is a DVR for each $\frakp\in\spec(A)$. Due to \thref{rem:fractional-inv-iff-integral}, it to show that every integral ideal of $A_\frakp$ is invertible for each $\frakp\in\spec(A)$. Let $\frakb$ be an integral ideal in $A_\frakp$, then there is a corresponnding integral ideal $\fraka$ in $A$ such that $\frakb = \fraka_\frakp$. According to our assumption, there is a fractional ideal $M$ such that $\fraka M = A$ whence $\fraka_\frakp M_\frakp = A_\frakp$ and $\frakb$ is invertible. This completes the proof.
\end{proof}

\begin{corollary}
    If $A$ is a Dedekind domain, the non-zero fractional ideals of $A$ form a group with respect to multiplication. 
\end{corollary}

\section{Dedekind Domains and Extensions}

\begin{theorem}
    Let $A$ be a Dedekind domain with field of fractions $K$. If $L/K$ is a separable field extension and $B$ is the integral closure of $A$ in $L$, then $B$ is a Dedekind domain.
\end{theorem}
\begin{proof}
    Obviously, $B$ is integrally closed. We now show that $B$ has Krull dimension $1$. First, note that the only prime ideal in $B$ lying over $(0)$ in $A$ is $(0)$ due to \thref{prop:unique-prime-lying-over}. If $\frakp_1\subsetneq\frakp_2$ in $B$, then their contractions $\frakp_1^c\subsetneq\frakp_2^c$ are prime ideals in $A$, where the inclusion is strict, again due to \thref{prop:unique-prime-lying-over}. Thus, $\frakp_1^c = (0)$ and $B$ has dimension $1$.

    Finally, that $B$ is a noethering follows from \thref{corr:noetherian-pid-free}. This completes the proof.
\end{proof}

\begin{theorem}
    Let $A$ be a Dedekind domain with field of fractions $K$. If $L/K$ is a finite purely inseparable extension and $B$ is the integral closure of $A$ in $L$, then $B$ is a Dedekind domain.
\end{theorem}
\begin{proof}
    We shall show that every ideal of $B$ is invertible. This is equivalent to $B$ being a Dedekind domain. Let $\chr A = p > 0$ and $q = p^n$ be the exponent of the purely inseparable extension $L/K$. Let $\frakb$ be an ideal of $B$ and 
    \begin{equation*}
        \fraka = \{b^q\mid b\in\frakb\}A,
    \end{equation*}
    an ideal of $A$. Since $A$ is a Dedekind domain, the ideal $\fraka$ has an inverse, say $\fraka^{-1}$. Let $\fraka^{-1}_B$ denote the $B$-submodule of $L$ generated by $\fraka^{-1}$. Since $\fraka^{-1}$ was a fractional ideal of $A$, there is some $d\in A$ such that $d\fraka^{-1}\subseteq A$, therefore, $d\fraka^{-1}_B\subseteq B$ and $\fraka^{-1}_B$ is a fractional ideal of $B$.

    Now, note that $\fraka\subseteq\frakb^q$ whence 
    \begin{equation*}
        1\in\fraka\fraka^{-1}\subseteq\frakb^q\fraka_B^{-1}\implies B\subseteq\frakb^q\fraka^{-1}_B.
    \end{equation*}
    
    On the other hand, pick some $a\in\fraka^{-1}$ and $b_1,\dots,b_q\in\frakb$. Then, 
    \begin{equation*}
        (b_1\cdots b_q a)^q = (b_1^qa)\cdots(b_q^qa).
    \end{equation*}
    Note that $b_i^q\in\fraka$ an thus $b_i^qa\in A$. Therefore, $b_1\cdots b_qa$ is integral over $A$ and thus lies in $B$. Note that every element of $\frakb^q\fraka_B^{-1}$ is a $B$-linear combination of elements of th form $b_1\cdots b_qa$ and thus lies in $B$, that is, $\frakb^q\fraka_B^{-1}\subseteq B$. Hence, 
    \begin{equation*}
        \frakb^q\fraka^{-1}_B = B\implies\frakb^{-1} = \frakb^{q - 1}\fraka^{-1}_B.
    \end{equation*}
    This completes the proof.
\end{proof}

We immediately obtain the following result.

\begin{corollary}
    Let $A$ be a Dedekind domain with field of fractions $K$. If $L/K$ is a finite extension and $B$ is the integral closure of $A$ in $L$, then $B$ is a Dedekind domain.
\end{corollary}

\subsection{Primes in Extensions}

Throughout this section, we consider the following setup: 
\begin{quotation}
    $A$ is a Dedekind domain with fraction field $K$. Let $L/K$ be a finite extension and $B$ the integral closure of $A$ in $L$.
\end{quotation}

\begin{definition}
    If $\frakp\in\spec(A)$, then $\frakp B$ has a prime factorization in $B$, say 
    \begin{equation*}
        \frakp B = \prod_{i = 1}^r\frakP_i^{e_i}.
    \end{equation*}
    The number $e_i$ is called the \emph{ramification index}. We say that $\frakP$ divides $\frakp$ if $\frakP$ occurs in the factorization of $\frakp$ in $B$. Further, we write $e(\frakP/\frakp)$ for the ramification index and $f(\frakP/\frakp)$ for the degree of the field extension $[B/\frakP: A/\frakp]$.

    A prime is said to \emph{ramify} if $e_i > 1$ for some $i$. It is said to \emph{split} if $e_i = f_i = 1$ for all $i$. It is said to be \emph{inert} if $\frakp B$ is a prime ideal in $B$.
\end{definition}

\begin{proposition}
    Let $\frakp\in\spec(A)$. Then, $\frakP$ divides $\frakp$ if and only if $\frakP$ lies over $\frakp$.
\end{proposition}
\begin{proof}
    $\implies$ Obviously $\frakP\cap A$ contains $\frakp$. But since $\frakp$ is maximal, and $1\notin\frakP$, we have $\frakp = \frakP\cap A$.

    $\impliedby$ Suppose $\frakP$ lies over $\frakp$. Then, $\frakp B\subseteq\frakP$. Consider the prime factorization 
    \begin{equation*}
        \prod_{i = 1}^r \frakP^{e_i} = \frakp B\subseteq\frakP\implies\prod_{i = 1}^r\frakP_i\subseteq\frakP
    \end{equation*}
    and thus $\frakP_i\subseteq\frakP$ for some $i$. But since the $\frakP_i$'s are maximal, we have $\frakP_i = \frakP$ for some $i$.
\end{proof}

\begin{theorem}[Ramification Formula]
    Suppose $L/K$ is separable with $[L: K] = m$ and $\frakP_1,\dots,\frakP_r$ be the prime ideals dividing $\frakp$. Then, 
    \begin{equation*}
        \sum_{i = 1}^r e_if_i = m,
    \end{equation*}
    where $e_i = e(\frakP_i/\frakp)$ and $f_i = f(\frakP_i/\frakp)$.
\end{theorem}
\begin{proof}
    We shall first show that $B/\frakp B$ is a vector space of dimension $m$ over $A/\frakp$. It obviously is a finite dimensional vector space over $A/\frakp$ an thus 
    \begin{equation*}
        B/\frakp B\cong (A/\frakp)^s
    \end{equation*}
    for some positive integer $s$. Localizing at $\frakp$, we have 
    \begin{equation*}
        B_\frakp/(\frakp_\frakp B_\frakp)\cong (A_\frakp/\frakp_\frakp)^s.
    \end{equation*}
    Note that $A_\frakp$ is a DVR, in particular, a PID. Hence, $B_\frakp$ is a free $A_\frakp$-module since we had already established that $B$ was a finitely generated $A$-module. Let $n$ be a positive integer such that $B_\frakp\cong A_\frakp^n$ as $A_\frakp$-modules. Then, upon tensoring with $K$, have an isomorphism\footnote{In general, if $A\subseteq B$ is an integral extension of integral domains, then any element in the localization of $B$ at $A\backslash\{0\}$. Note that any element in the fraction field of $B$ is of the form $b/b'$, which can be written in the form $b''/a$ for some $b''\in B$ and $a\in A$.} of $A_\frakp$-modules and thus of $K$-vector spaces, $K^n\longrightarrow L$ whence $n = m$. On the other hand, upon tensoring with $A_\frakp/\frakp$, we have an isomorphism 
    \begin{equation*}
        B_\frakp/(\frakp_\frakp B_\frakp)\cong(A_\frakp/\frakp_\frakp)^m,
    \end{equation*}
    whence $m = s$. This proves our claim.

    Now, using the Chinese Remainder Theorem, we have an isomorphism,
    \begin{equation*}
        B/\frakp B\cong \prod_{i = 1}^r B/\frakP_i^{e_i}.
    \end{equation*}
    Note that this is also an isomorphism as $A/\frakp$-modules. We shall show, individually, that $[B/\frakP_i^{e_i}: A/\frakp] = e_if_i$. First, consider the chain 
    \begin{equation*}
        B\supsetneq\frakP_i\supsetneq\cdots\supsetneq\frakP_i^{e_i}.
    \end{equation*}
    Since there is no ideal strictly between $\frakP_i^j$ and $\frakP_i^{j + 1}$, each successive quotient above must have dimension $1$ as a $B/\frakP_i$-vector space. But $B/\frakP_i$ itself is a $f_i$ dimensional $A/\frakp$-vector space, whence $B/\frakP_i^{e_i}$ is  $e_if_i$ dimensional $A/\frakp$-vector space. This completes the proof.
\end{proof}